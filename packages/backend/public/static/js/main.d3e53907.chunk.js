(this["webpackJsonpfrontend-v2"]=this["webpackJsonpfrontend-v2"]||[]).push([[0],{111:function(e,t,a){},112:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),l=a.n(c),u=a(4),i=a(10),o=a(3),s=a(119),m=a(1),d=a.n(m),b=a(5);function p(e){var t=Object(n.useState)([]),a=Object(o.a)(t,2),r=a[0],c=a[1],l=Object(n.useCallback)(Object(b.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.service.getAll();case 2:(a=t.sent)&&c(a.data);case 4:case"end":return t.stop()}}),t)}))),[e.service]);return Object(n.useEffect)((function(){l()}),[l]),[r,l]}var f=a(22),v=a(25),E=a(53),h=a.n(E);function g(e,t){return O.apply(this,arguments)}function O(){return(O=Object(b.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("auth/login",{username:t,password:a});case 2:return n=e.sent,N((r=null===n||void 0===n?void 0:n.data).token),y(r.user),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){e&&localStorage.setItem("LS_USER_INFO",JSON.stringify(e))}function j(){var e=localStorage.getItem("LS_USER_INFO");return e?JSON.parse(e):null}function N(e){if(!e)throw Error("no_token_defined");localStorage.setItem("LS_TOKEN",e)}function w(){return localStorage.getItem("LS_TOKEN")}var x;function k(e,t){return S.apply(this,arguments)}function S(){return(S=Object(b.a)(d.a.mark((function e(t,a){var n,r,c,l=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=l.length>2&&void 0!==l[2]?l[2]:void 0,r=h.a.create({baseURL:"/api/"}),(c=w())&&(r.defaults.headers.common.Authorization="Bearer ".concat(c)),e.t0=a,e.next=e.t0===x.GET?7:e.t0===x.POST?8:e.t0===x.PUT?9:e.t0===x.PATCH?10:e.t0===x.DELETE?11:12;break;case 7:return e.abrupt("return",r.get(t,{params:n}));case 8:return e.abrupt("return",r.post(t,n));case 9:return e.abrupt("return",r.put(t,n));case 10:return e.abrupt("return",r.patch(t,n));case 11:return e.abrupt("return",r.delete(t));case 12:return e.abrupt("break",13);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return k(e,x.GET,t)}function T(e,t){return k(e,x.POST,t)}!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE"}(x||(x={}));var F,I=function(){function e(t){Object(f.a)(this,e),this.resourceURL=t}return Object(v.a)(e,[{key:"getAll",value:function(){return P(this.resourceURL)}},{key:"getByID",value:function(e){return P("".concat(this.resourceURL,"/").concat(e))}},{key:"add",value:function(e){return T(this.resourceURL,e)}},{key:"update",value:function(e,t){return function(e,t){return k(e,x.PUT,t)}("".concat(this.resourceURL,"/").concat(e),t)}},{key:"delete",value:function(e){return k("".concat(this.resourceURL,"/").concat(e),x.DELETE)}}]),e}(),A=new I("members"),C=a(30),L=a(118),R=a(122),D=a(117),B=a(121),U=function(e){var t=e.column,a=t.filterValue,n=t.preFilteredRows,c=t.setFilter,l=n.length;return r.a.createElement(D.a,{className:"mb-3"},r.a.createElement(D.a.Append,null,r.a.createElement(D.a.Text,null,"\ud83d\udd0e")),r.a.createElement(B.a,{value:a||"",onChange:function(e){c(e.target.value||void 0)},placeholder:"Search ".concat(l," records...")}))},_=function(e){var t=Object(n.useMemo)((function(){return e.data}),[e.data]),a=Object(n.useMemo)((function(){return e.columns}),[e.columns]),c=r.a.useMemo((function(){return{text:function(e,t,a){return e.filter((function(e){var n=e.values[t];return void 0===n||String(n).toLowerCase().startsWith(String(a).toLowerCase())}))}}}),[]),l=r.a.useMemo((function(){return{Filter:U}}),[]),u=Object(C.useTable)({columns:a,data:t,defaultColumn:l,filterTypes:c,initialState:{pageIndex:0,pageSize:e.pageSize||20}},C.useFilters,C.useSortBy,C.usePagination),i=u.getTableProps,o=u.getTableBodyProps,s=u.headerGroups,m=u.page,d=u.pageCount,b=u.gotoPage,p=u.prepareRow,f=u.state.pageIndex;return r.a.createElement(r.a.Fragment,null,r.a.createElement(L.a,Object.assign({id:e.id,className:e.className},i()),r.a.createElement("thead",null,s.map((function(e){return r.a.createElement("tr",e.getHeaderGroupProps(),e.headers.map((function(e){return r.a.createElement("th",e.getHeaderProps(),r.a.createElement(H,{column:e}),r.a.createElement(G,{column:e}))})))}))),r.a.createElement("tbody",o(),m.map((function(t){p(t);var a=e.customRowProps?e.customRowProps(t):{};return r.a.createElement("tr",t.getRowProps(a),t.cells.map((function(e){return r.a.createElement("td",e.getCellProps(),e.render("Cell"))})))})))),r.a.createElement(q,{pageCount:d,current:f,gotoPage:b}))},q=function(e){for(var t=e.current,a=[],n=function(n){a.push(r.a.createElement(R.a.Item,{key:n,active:n-1===t,onClick:function(){return e.gotoPage(n-1)}},n))},c=1;c<=e.pageCount;c++)n(c);return r.a.createElement(R.a,null,t-1>=0&&r.a.createElement(R.a.Prev,{onClick:function(){return e.gotoPage(t-1)}}),a,t+1<e.pageCount&&r.a.createElement(R.a.Next,{onClick:function(){return e.gotoPage(t+1)}}))},H=function(e){var t=e.column;return r.a.createElement("div",t.getSortByToggleProps(),t.render("Header"),r.a.createElement("span",null,t.isSorted?t.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""))},G=function(e){var t=e.column;return r.a.createElement("div",null,t.canFilter?t.render("Filter"):null)},M=(a(91),function(){var e=p({service:A}),t=Object(o.a)(e,1)[0],a=[{Header:"Nom",accessor:"name"},{Header:"",accessor:"id",disableFilters:!0,disableSortBy:!0,Cell:function(e){return r.a.createElement(V,{id:e.value})}}],c=Object(n.useMemo)((function(){return t.map((function(e){var t,a;return{id:e.id,name:"".concat(null===(t=e.user)||void 0===t?void 0:t.firstname," ").concat(null===(a=e.user)||void 0===a?void 0:a.lastname),negativeBalance:e.balance<0}}))}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Membres"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(u.b,{to:"/admin/members/add",className:"btn btn-primary"},"Ajouter")),r.a.createElement("div",{className:"row"},r.a.createElement(_,{data:c,columns:a,customRowProps:function(e){return{className:c[e.index].negativeBalance?"member-table__row--negative-balance":""}}}))))}),V=function(e){return r.a.createElement(u.b,{component:s.a,to:"/admin/members/".concat(e.id)},"...")},W=a(7),J=a(9),z=a(120),K=new I("memberlabels"),$=function(e){var t=e.className,a=e.label,n=e.type,c=e.formnikError,l=e.name;return r.a.createElement("div",{className:"form-group ".concat(t)},r.a.createElement("label",null,a),r.a.createElement(J.b,{className:"form-control ".concat(c?"is-invalid":""),name:l,type:n}),r.a.createElement(J.a,{name:l,component:"div",className:"invalid-feedback"}))},Q=function(e){var t,a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],i=c[1],m=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getAll();case 2:(t=e.sent)&&r(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),a}(),p={memberLabels:[],user:{email:"",firstname:"",lastname:"",birthdate:"",phone:"",street:"",streetNumber:null,city:"",postalCode:null},global:""};e.member&&(p.memberLabels=(null===(t=e.member.memberLabels)||void 0===t?void 0:t.map((function(e){return e.id})))||[],p.user=Object(W.a)(Object(W.a)({},p.user),e.member.user));var f=function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.setSubmitting,c=n.setFieldError,t.prev=1,a=Object(W.a)(Object(W.a)({},a),{},{memberLabels:a.memberLabels.map((function(e){return m.find((function(t){return t.id===Number.parseInt(e)}))}))}),!(null===(l=e.member)||void 0===l?void 0:l.id)){t.next=8;break}return t.next=6,A.update(e.member.id,a);case 6:t.next=10;break;case 8:return t.next=10,A.add(Object(W.a)(Object(W.a)({},a),{},{organisation:{id:e.organisationID}}));case 10:i(!0),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),console.error(t.t0),t.t0.message?c("global",t.t0.message):c("global","Erreur serveur...");case 17:r(!1);case 18:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(J.d,{initialValues:p,validate:function(e){var t={};return e.user.email||(t.user={},t.user.email="Requis"),t},onSubmit:f},(function(e){var t,a,n,c,o,d,b,p,f,v=e.isSubmitting,E=e.errors;e.setFieldValue,e.values;return r.a.createElement(J.c,null,l&&r.a.createElement(z.a,{variant:"success",onClose:function(){return i(!1)},dismissible:!0},"Le membre a bien \xe9t\xe9 sauv\xe9 !"),r.a.createElement(J.a,{name:"global",component:function(e){return r.a.createElement(z.a,{variant:"danger"},e.children)}}),r.a.createElement("div",null,r.a.createElement("h2",null,"Tag"),r.a.createElement(J.b,{component:"select",multiple:!0,name:"memberLabels",className:"form-control"},m.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement("h2",null,"Informations g\xe9n\xe9rales"),r.a.createElement($,{label:"Email",type:"text",formnikError:null===(t=E.user)||void 0===t?void 0:t.email,name:"user.email"}),r.a.createElement($,{label:"Nom",type:"text",formnikError:null===(a=E.user)||void 0===a?void 0:a.lastname,name:"user.lastname"}),r.a.createElement($,{label:"Pr\xe9nom",type:"text",formnikError:null===(n=E.user)||void 0===n?void 0:n.firstname,name:"user.firstname"}),r.a.createElement($,{label:"Date de naissance",type:"date",formnikError:null===(c=E.user)||void 0===c?void 0:c.birthdate,name:"user.birthdate"}),r.a.createElement($,{label:"T\xe9l\xe9phone",type:"text",formnikError:null===(o=E.user)||void 0===o?void 0:o.phone,name:"user.phone"}),r.a.createElement("h2",null,"Adresse"),r.a.createElement("div",{className:"form-row"},r.a.createElement($,{className:"col-8",label:"Rue",type:"text",formnikError:null===(d=E.user)||void 0===d?void 0:d.street,name:"user.street"}),r.a.createElement($,{className:"col",label:"Num\xe9ro",type:"number",formnikError:null===(b=E.user)||void 0===b?void 0:b.streetNumber,name:"user.streetNumber"})),r.a.createElement("div",{className:"form-row"},r.a.createElement($,{className:"col-4",label:"NPA",type:"number",formnikError:null===(p=E.user)||void 0===p?void 0:p.postalCode,name:"user.postalCode"}),r.a.createElement($,{className:"col",label:"Ville",type:"text",formnikError:null===(f=E.user)||void 0===f?void 0:f.city,name:"user.city"}))),r.a.createElement(s.a,{variant:"primary",type:"submit",disabled:v},"Sauver"),r.a.createElement(u.b,{to:"/admin/members"},r.a.createElement(s.a,{variant:"secondary"},"Annuler")))}))},X=function(){var e=Object(n.useState)(0),t=Object(o.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e,t=j();(null===t||void 0===t||null===(e=t.organisation)||void 0===e?void 0:e.id)&&r(null===t||void 0===t?void 0:t.organisation.id)}),[]),[a,r]},Y=function(e){var t,a=Object(i.h)().id,c=Object(n.useState)(null),l=Object(o.a)(c,2),u=l[0],s=l[1],m=X(),p=Object(o.a)(m,1)[0];return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getByID(a);case 2:(null===(t=e.sent)||void 0===t?void 0:t.data)&&s(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a]),u?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,null===(t=u.user)||void 0===t?void 0:t.email),r.a.createElement(Q,{organisationID:p,member:u})):r.a.createElement(r.a.Fragment,null,"loading...")},Z=function(e){var t=X(),a=Object(o.a)(t,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{organisationID:a}))},ee=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e),exact:!0},r.a.createElement(M,null)),r.a.createElement(i.b,{path:"".concat(e,"/add")},r.a.createElement(Z,null)),r.a.createElement(i.b,{path:"".concat(e,"/:id")},r.a.createElement(Y,null)),r.a.createElement(i.a,{to:"".concat(e)}))},te=new I("clubs"),ae=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.getAll();case 2:(t=e.sent)&&c(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Clubs"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(u.b,{to:"/admin/clubs/add",className:"btn btn-primary"},"Ajouter")),r.a.createElement("div",{className:"row"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement(ne,{club:e,key:e.id})})))))))},ne=function(e){var t=e.club;return r.a.createElement("tr",null,r.a.createElement("td",null,t.id),r.a.createElement("td",null,t.name),r.a.createElement("td",null,r.a.createElement(u.b,{to:"/admin/clubs/".concat(t.id)},"...")))},re=function(e){var t=e.type,a=e.variant,n=e.className,c=e.id,l=e.disabled;return r.a.createElement("button",{type:t||"button",id:c,className:"btn ".concat(a?"btn-".concat(a):""," ").concat(n),disabled:l},e.children)},ce=function(e){var t=e.variant,a=e.className,n=e.id;return r.a.createElement("div",{id:n,className:"alert ".concat(t?"alert-".concat(t):""," ").concat(a)},e.children)},le=function(e){var t=e.club?{name:e.club.name,global:""}:{name:"",global:""},a=function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.setSubmitting,c=n.setFieldError,t.prev=1,!(null===(l=e.club)||void 0===l?void 0:l.id)){t.next=7;break}return t.next=5,te.update(e.club.id,a);case 5:t.next=9;break;case 7:return t.next=9,te.add(Object(W.a)(Object(W.a)({},a),{},{organisation:{id:e.organisationID}}));case 9:e.onSubmit(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.error(t.t0),t.t0.message?c("global",t.t0.message):c("global","Erreur serveur...");case 16:r(!1);case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(J.d,{initialValues:t,validate:function(e){var t={};return e.name||(t.name="Required"),t},onSubmit:a},(function(e){var t=e.isSubmitting,a=e.errors;return r.a.createElement(J.c,null,r.a.createElement(J.a,{name:"global",component:function(e){return r.a.createElement(ce,{variant:"danger"},e.children)}}),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Nom"),r.a.createElement(J.b,{className:"form-control ".concat(a.name?"is-invalid":""),name:"name"}),r.a.createElement(J.a,{name:"name",component:"div",className:"invalid-feedback"})),r.a.createElement(re,{variant:"primary",type:"submit",disabled:t},"Sauver"),r.a.createElement(u.b,{to:"/admin/clubs"},r.a.createElement(re,{variant:"secondary"},"Annuler")))}))},ue=function(e){var t=Object(n.useState)(0),a=Object(o.a)(t,2),c=a[0],l=a[1];Object(n.useEffect)((function(){var e,t=j();(null===t||void 0===t||null===(e=t.organisation)||void 0===e?void 0:e.id)&&l(null===t||void 0===t?void 0:t.organisation.id)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(le,{organisationID:c,onSubmit:function(){window.history.back()}}))},ie=function(e){var t=Object(n.useState)(0),a=Object(o.a)(t,2),c=a[0],l=a[1],u=Object(i.h)().id,s=Object(n.useState)(null),m=Object(o.a)(s,2),p=m[0],f=m[1];Object(n.useEffect)((function(){var e,t=j();(null===t||void 0===t||null===(e=t.organisation)||void 0===e?void 0:e.id)&&l(null===t||void 0===t?void 0:t.organisation.id)}),[]),Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.getByID(u);case 2:(null===(t=e.sent)||void 0===t?void 0:t.data)&&f(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[u]);return p?r.a.createElement(r.a.Fragment,null,r.a.createElement(le,{club:p,organisationID:c,onSubmit:function(){}})):r.a.createElement(r.a.Fragment,null,"loading...")},oe=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e),exact:!0},r.a.createElement(ae,null)),r.a.createElement(i.b,{path:"".concat(e,"/add")},r.a.createElement(ue,null)),r.a.createElement(i.b,{path:"".concat(e,"/:id")},r.a.createElement(ie,null)),r.a.createElement(i.a,{to:"".concat(e)}))};!function(e){e[e.weekly=0]="weekly",e[e.monthly=1]="monthly",e[e.quarterly=2]="quarterly",e[e.biannual=3]="biannual",e[e.annual=4]="annual"}(F||(F={}));var se,me=function(e){switch(e){case F.weekly:return"hebdomadaire";case F.monthly:return"mensuel";case F.quarterly:return"trimestriel";case F.biannual:return"semestriel";case F.annual:return"annuel";default:return"sp\xe9cial"}},de=new I("membership-plans"),be=function(){var e=p({service:de}),t=Object(o.a)(e,2),a=t[0],n=t[1],c=a.map((function(e){return Object(W.a)(Object(W.a)({},e),{},{tacit:e.tacit?"oui":"non",type:me(e.type)})})),l=[{Header:"Prix",accessor:"price"},{Header:"Description",accessor:"description"},{Header:"Type",accessor:"type"},{Header:"Tacite",accessor:"tacit"},{Header:"Action",accessor:"id",disableFilters:!0,disableSortBy:!0,Cell:function(e){return r.a.createElement(pe,{plan:e.row.values,refreshList:n})}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Gestion des abonnements"),r.a.createElement("div",{className:"row"},r.a.createElement(u.b,{to:"/admin/membershipPlans/add",className:"btn btn-primary"},"Ajouter"),r.a.createElement(_,{data:c,columns:l})))},pe=function(e){var t=e.plan,a=e.refreshList,n=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,de.delete(t.id);case 4:e.sent&&a();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("tr",null,r.a.createElement("td",null,t.price),r.a.createElement("td",null,me(t.type)),r.a.createElement("td",null,t.tacit?"oui":"non"),r.a.createElement("td",null,r.a.createElement(u.b,{to:"/admin/membershipPlans/update/".concat(t.id),className:"btn btn-primary"},"Modifier"),r.a.createElement("button",{className:"btn",onClick:function(e){return n(t)}},"Supprimer")))},fe=function(e){var t=e.membershipPlan?Object(W.a)({},e.membershipPlan):{price:0,description:"",type:1,tacit:!1},a=function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.setSubmitting,c=n.setFieldError,t.prev=1,!(null===(l=e.membershipPlan)||void 0===l?void 0:l.id)){t.next=7;break}return t.next=5,de.update(e.membershipPlan.id,a);case 5:t.next=10;break;case 7:return a.organisation={id:e.organisationID},t.next=10,de.add(Object(W.a)({},a));case 10:t.next=17;break;case 12:t.prev=12,t.t0=t.catch(1),console.error(t.t0),t.t0.message?c("global",t.t0.message):c("global","Erreur serveur..."),r(!1);case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement("div",{id:"membershipPlanForm"},r.a.createElement(J.d,{initialValues:t,validate:function(e){var t={};return e.price||(t.price="Required"),t},onSubmit:a},(function(e){var a=e.isSubmitting,n=e.errors;return r.a.createElement(J.c,null,r.a.createElement("label",{htmlFor:"price"},"Prix"),r.a.createElement(J.b,{className:"form-control ".concat(n.price?"is-invalid":""),name:"price"}),r.a.createElement("label",{htmlFor:"type"},"Type"),r.a.createElement(J.b,{className:"form-control ".concat(n.type?"is-invalid":""),name:"type"}),r.a.createElement("label",{htmlFor:"tacit"},"Tacite"),r.a.createElement(J.b,{className:"form-control ".concat(n.type?"is-invalid":""),name:"tacit",value:t.tacit?"oui":"non"}),r.a.createElement(re,{variant:"primary",type:"submit",disabled:a},"Sauver"),r.a.createElement(u.b,{to:"/admin/membershipPlans"},r.a.createElement(re,{variant:"secondary"},"Annuler")))})))},ve=function(e){var t=Object(n.useState)(0),a=Object(o.a)(t,2),c=a[0],l=a[1],u=Object(n.useState)(),s=Object(o.a)(u,2),m=s[0],p=s[1],f=Object(i.h)().id;return Object(n.useEffect)((function(){var e,t=j();(null===t||void 0===t||null===(e=t.organisation)||void 0===e?void 0:e.id)&&l(null===t||void 0===t?void 0:t.organisation.id),f&&function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.getByID(f);case 2:(t=e.sent)&&p(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[f]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Ajout d'abonnement"),r.a.createElement("div",null,f?m?r.a.createElement(fe,{organisationID:c,membershipPlan:m}):null:r.a.createElement(fe,{organisationID:c})))},Ee=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e),exact:!0},r.a.createElement(be,null)),r.a.createElement(i.b,{path:"".concat(e,"/add")},r.a.createElement(ve,null)),r.a.createElement(i.b,{path:"".concat(e,"/update/:id")},r.a.createElement(ve,null)),r.a.createElement(i.a,{to:"".concat(e)}))},he=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getAll();case 2:(t=e.sent)&&c(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Tag de membre"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(u.b,{to:"/admin/memberlabels/add",className:"btn btn-primary"},"Ajouter")),r.a.createElement("div",{className:"row"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement(ge,{label:e,key:e.id})})))))))},ge=function(e){var t=e.label;return r.a.createElement("tr",null,r.a.createElement("td",null,t.id),r.a.createElement("td",null,t.name),r.a.createElement("td",null,r.a.createElement(u.b,{to:"/admin/memberlabels/".concat(t.id)},"...")))},Oe=function(e){var t={name:"",global:""};e.label&&(t=Object(W.a)(Object(W.a)({},t),e.label));var a=function(){var t=Object(b.a)(d.a.mark((function t(a,n){var r,c,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.setSubmitting,c=n.setFieldError,t.prev=1,!(null===(l=e.label)||void 0===l?void 0:l.id)){t.next=7;break}return t.next=5,K.update(e.label.id,a);case 5:t.next=9;break;case 7:return t.next=9,K.add(Object(W.a)(Object(W.a)({},a),{},{organisation:{id:e.organisationID}}));case 9:e.onSubmit(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.error(t.t0),t.t0.message?c("global",t.t0.message):c("global","Erreur serveur...");case 16:r(!1);case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,a){return t.apply(this,arguments)}}();return r.a.createElement(J.d,{initialValues:t,validate:function(e){var t={};return e.name||(t.name="Required"),t},onSubmit:a},(function(e){var t=e.isSubmitting,a=e.errors;return r.a.createElement(J.c,null,r.a.createElement(J.a,{name:"global",component:function(e){return r.a.createElement(z.a,{variant:"danger"},e.children)}}),r.a.createElement($,{formnikError:a.name,label:"Nom du tag",name:"name",type:"text"}),r.a.createElement(s.a,{variant:"primary",type:"submit",disabled:t},"Sauver"),r.a.createElement(u.b,{to:"/admin/memberlabels"},r.a.createElement(s.a,{variant:"secondary"},"Annuler")))}))},ye=function(e){var t=X(),a=Object(o.a)(t,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,{organisationID:a,onSubmit:function(){window.history.back()}}))},je=function(e){var t=X(),a=Object(o.a)(t,1)[0],c=Object(i.h)().id,l=Object(n.useState)(null),u=Object(o.a)(l,2),s=u[0],m=u[1];Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getByID(c);case 2:(null===(t=e.sent)||void 0===t?void 0:t.data)&&m(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]);return s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,{label:s,organisationID:a,onSubmit:function(){window.history.back()}})):r.a.createElement(r.a.Fragment,null,"loading....")},Ne=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e),exact:!0},r.a.createElement(he,null)),r.a.createElement(i.b,{path:"".concat(e,"/add")},r.a.createElement(ye,null)),r.a.createElement(i.b,{path:"".concat(e,"/:id")},r.a.createElement(je,null)),r.a.createElement(i.a,{to:"".concat(e)}))},we=function(e){var t=e.title,a=e.children;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},t),r.a.createElement("div",null,a)))},xe=a(27),ke=a(26),Se=new(function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){return Object(f.a)(this,a),t.call(this,"dashboard")}return a}(I)),Pe=function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){(function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.getAll();case 2:(t=e.sent)&&c(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Tableau de bord"),r.a.createElement("hr",null),r.a.createElement("div",{className:"card-deck"},r.a.createElement(we,{title:"Membres ayant leur anniversaire dans 7 jours: "+a.birthdays.length},r.a.createElement("ul",{className:"list-group"},a.birthdays.map((function(e){var t,a;return r.a.createElement("li",{className:"list-group-item"},r.a.createElement(u.b,{to:"/admin/members/".concat(e.id)},null===(t=e.user)||void 0===t?void 0:t.firstname," ",null===(a=e.user)||void 0===a?void 0:a.lastname))})))),r.a.createElement(we,{title:"Membres ayant une balance n\xe9gative: "+a.negativeBalanceUsers.length},r.a.createElement("ul",{className:"list-group"},a.negativeBalanceUsers.map((function(e){var t,a;return r.a.createElement("li",{className:"list-group-item"},r.a.createElement(u.b,{to:"/admin/members/".concat(e.id)},null===(t=e.user)||void 0===t?void 0:t.firstname," ",null===(a=e.user)||void 0===a?void 0:a.lastname))})))))):r.a.createElement("div",null,"Loading...")},Te=new(function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){return Object(f.a)(this,a),t.call(this,"memberships")}return Object(v.a)(a,[{key:"getNotPaid",value:function(){return P("memberships/notPaid")}}]),a}(I)),Fe=new(function(e){Object(xe.a)(a,e);var t=Object(ke.a)(a);function a(){return Object(f.a)(this,a),t.call(this,"payments")}return Object(v.a)(a,[{key:"createPaymentWithoutRequest",value:function(e){return T("payments/payment-without-request",e)}}]),a}(I)),Ie=new I("payment-requests"),Ae=function(e){var t,a,c,l,u,i,s=e.memberShip,m=e.onPaymentReceivedFunction,p=Object(n.useState)(!1),f=Object(o.a)(p,2),v=f[0],E=f[1];Object(n.useEffect)((function(){s.paymentRequest&&E(!0)}),[s.paymentRequest]);var h=function(){var e=Object(b.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.plan){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Ie.add({amount:t.plan.price,date:new Date,description:"demand\xe9 manuellement"});case 5:return a=e.sent,e.next=8,Te.update(t.id,{paymentRequest:null===a||void 0===a?void 0:a.data});case 8:E(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("error on createPaymentRequest()",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.plan){e.next=2;break}return e.abrupt("return");case 2:if(a={amount:t.plan.price,date:new Date,hasBeenCanceled:!1},e.prev=3,!v){e.next=12;break}return a.paymentRequest=t.paymentRequest,a.member=t.member,e.next=9,Fe.add(a);case 9:n=e.sent,e.next=15;break;case 12:return e.next=14,Fe.createPaymentWithoutRequest({payment:a,memberShip:t});case 14:n=e.sent;case 15:n&&m(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},null===(t=s.member)||void 0===t||null===(a=t.user)||void 0===a?void 0:a.firstname," ",null===(c=s.member)||void 0===c||null===(l=c.user)||void 0===l?void 0:l.lastname),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Abonnement ",me(null===(u=s.plan)||void 0===u?void 0:u.type),", \xe9chu le"," ",s.endDate),"prix : ",null===(i=s.plan)||void 0===i?void 0:i.price,".-",r.a.createElement("div",{className:"float-right"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h(s));case 1:case"end":return e.stop()}}),e)}))),disabled:v},"Paiment demand\xe9"),r.a.createElement("button",{type:"button",className:"btn btn-success",onClick:Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g(s));case 1:case"end":return e.stop()}}),e)})))},"Argent re\xe7u"))))},Ce=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],c=t[1],l=function(){var e=Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te.getNotPaid();case 2:t=e.sent,c(null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){l()}),[]);var u=function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h1",null,"Gestion de paiements"),a.map((function(e){return r.a.createElement(Ae,{key:e.id,memberShip:e,onPaymentReceivedFunction:function(){u()}})})))},Le=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e),exact:!0},r.a.createElement(Ce,null)),r.a.createElement(i.a,{to:"".concat(e)}))},Re=function(){var e=Object(i.i)().path;return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"".concat(e,"/"),exact:!0},r.a.createElement(Pe,null)),r.a.createElement(i.b,{path:"".concat(e,"/members")},r.a.createElement(ee,null)),r.a.createElement(i.b,{path:"".concat(e,"/clubs")},r.a.createElement(oe,null)),r.a.createElement(i.b,{path:"".concat(e,"/dashboard")},r.a.createElement(Pe,null)),r.a.createElement(i.b,{path:"".concat(e,"/membershipPlans")},r.a.createElement(Ee,null)),r.a.createElement(i.b,{path:"".concat(e,"/payments")},r.a.createElement(Le,null)),r.a.createElement(i.b,{path:"".concat(e,"/memberlabels")},r.a.createElement(Ne,null)))},De=(a(95),a(58)),Be=(a(111),function(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),c=a[0],l=a[1],s=Object(i.g)();Object(n.useEffect)((function(){l(!1)}),[s]);return r.a.createElement("div",{id:"sidebar"},r.a.createElement(De.slide,Object.assign({},e,{width:"40%",isOpen:c,onStateChange:function(e){return function(e){l(e.isOpen)}(e)},disableAutoFocus:!0}),e.links.map((function(e){return r.a.createElement(u.b,{className:"menu-item",to:e.to,key:e.to},e.displayName)}))))}),Ue=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"adminlayout"},r.a.createElement("div",{className:"navbar navbar-dark bg-primary flex-md-nowrap p-0"},r.a.createElement(u.b,{to:"/admin/dashboard",className:"navbar-brand col-md-3 col-lg-2 mr-0 px-3"},"Clug"),r.a.createElement("ul",{className:"navbar-nav px-3"},r.a.createElement("li",{className:"nav-item text-nowrap"},r.a.createElement(u.b,{className:"nav-link",to:"/logout"},"D\xe9connexion")))),r.a.createElement(Be,{links:[{displayName:"Tableau de bord",to:"/admin/dashboard"},{displayName:"Membres",to:"/admin/members"},{displayName:"Clubs",to:"/admin/clubs"},{displayName:"Abonnements",to:"/admin/membershipPlans"},{displayName:"Paiements",to:"/admin/payments"},{displayName:"Tag de membre",to:"/admin/memberlabels"}],pageWrapId:"mainContent",outerContainerId:"adminLayout"}),r.a.createElement("div",{className:"container",id:"mainContent"},e.children)))},_e=(a(112),function(e){return r.a.createElement("div",{id:"basiclayout"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col main"},e.children))))});!function(e){e[e.INIT_APP=0]="INIT_APP",e[e.HAS_LOGIN=1]="HAS_LOGIN",e[e.LOGOUT=2]="LOGOUT"}(se||(se={}));var qe={isAuthentified:!1},He=r.a.createContext(null),Ge=function(e){var t=Object(n.useReducer)((function(e,t){switch(t.type){case se.INIT_APP:return Object(W.a)(Object(W.a)({},e),{},{isAuthentified:null!==w()});case se.HAS_LOGIN:return Object(W.a)(Object(W.a)({},e),{},{isAuthentified:!0});case se.LOGOUT:return localStorage.clear(),qe;default:return e}}),qe),a=Object(o.a)(t,2),c=a[0],l=a[1];return Object(n.useEffect)((function(){return l({type:se.INIT_APP})}),[]),r.a.createElement(He.Provider,{value:{state:c,dispatch:l}},e.children)},Me=Object(n.forwardRef)((function(e,t){var a=e.id,n=e.className,c=e.type,l=e.placeholder;return r.a.createElement("input",{ref:t,id:a,className:"form-control ".concat(n),type:c?"".concat(c):"text",placeholder:l})})),Ve=function(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useRef)(null),u=Object(n.useRef)(null),s=Object(n.useContext)(He);if(!s)return r.a.createElement(r.a.Fragment,null);if(s.state.isAuthentified)return r.a.createElement(i.a,{to:"/admin/dashboard"});var m=function(){var e=Object(b.a)(d.a.mark((function e(t){var a,n,r,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r=(null===(a=l.current)||void 0===a?void 0:a.value)?l.current.value:"",i=(null===(n=u.current)||void 0===n?void 0:n.value)?u.current.value:"",e.next=6,g(r,i);case 6:s.dispatch({type:se.HAS_LOGIN}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),e.t0.message?c({message:e.t0.message}):c({message:"Erreur serveur..."});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:m},a?r.a.createElement(ce,null,a.message):null,r.a.createElement(Me,{ref:l,placeholder:"username",type:"text"}),r.a.createElement(Me,{ref:u,placeholder:"password",type:"password"}),r.a.createElement(re,{type:"submit"},"Login"))},We=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve,null))},Je=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Bienvenue sur Clug App"),r.a.createElement(u.b,{to:"/login"},"Login"))},ze=function(){var e=Object(n.useContext)(He);return Object(n.useEffect)((function(){(null===e||void 0===e?void 0:e.state.isAuthentified)&&(null===e||void 0===e||e.dispatch({type:se.LOGOUT}))}),[e]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"A bient\xf4t !"))},Ke=function(){return r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/",exact:!0},r.a.createElement(_e,null,r.a.createElement(Je,null))),r.a.createElement(i.b,{path:"/admin"},r.a.createElement(Ue,null,r.a.createElement(Re,null))),r.a.createElement(i.b,{path:"/login"},r.a.createElement(_e,null,r.a.createElement(We,null))),r.a.createElement(i.b,{path:"/logout"},r.a.createElement(_e,null,r.a.createElement(ze,null))),r.a.createElement(i.b,null,r.a.createElement(_e,null,r.a.createElement("h1",null,"404: Nothing to see here...."))))},$e=function(e){return r.a.createElement(Ge,null,r.a.createElement(u.a,null,r.a.createElement(Ke,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(113),a(114);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($e,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,a){e.exports=a(115)},91:function(e,t,a){},95:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.d3e53907.chunk.js.map